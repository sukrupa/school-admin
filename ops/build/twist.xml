<project name="twist">

    <target name="twist:execute">
        <ant antfile="${ops.build.dir}/twist.xml"
             dir="${src.test.twist.fixtures.dir}"
             target="execute-twist"
             inheritall="true"
             inheritrefs="true">
        </ant>
    </target>

    <target name="execute-twist">
        <exec executable="${ops.local.dir}/kill-firefox.sh"/>
        <echo message="Executing Twist tests from ${src.test.twist.fixtures.dir}."/>

        <taskdef classname="com.thoughtworks.twist.core.execution.ant.ExecuteScenariosTask"
                 classpathref="classpath.run.twist.scenarios"
                 name="twist.runner"/>

        <twist.runner
                scenarioDir="${src.test.twist.fixtures.dir}/scenarios"
                reportsDir="${target.reports.dir}"
                confDir="${twist-config}"
                failureproperty="twist.scenarios.failed"
                classpathref="classpath.run.twist.scenarios"
                tags="!in-progress">
            <fileset dir="${src.test.twist.fixtures.dir}/scenarios" includes="*"/>
        </twist.runner>

        <exec executable="${ops.local.dir}/kill-firefox.sh"/>

        <fail if="twist.scenarios.failed" message="Twist tests have failed."/>
    </target>

</project>